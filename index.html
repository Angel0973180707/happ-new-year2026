<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ­è³€æ–°å–œ - å¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="manifest" id="manifest-placeholder">
    <meta name="theme-color" content="#b91c1c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://api.dicebear.com/7.x/noto-emoji/svg?seed=Lucky">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@700;900&family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        :root {
            --new-year-red: #b91c1c;
            --gold: #f59e0b;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #7f1d1d;
            color: #fff;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .serif { font-family: 'Noto Serif TC', serif; }

        .red-packet {
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }
        .red-packet:active { transform: scale(0.9); }

        .lantern {
            animation: swing 3s ease-in-out infinite alternate;
            transform-origin: top center;
        }

        @keyframes swing {
            from { transform: rotate(-5deg); }
            to { transform: rotate(5deg); }
        }

        .gold-text {
            background: linear-gradient(to bottom, #fde68a, #f59e0b, #d97706);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .modal-enter { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .sparkle {
            position: absolute;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            animation: fall linear infinite;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-between p-4 pb-12 relative">

    <!-- è£é£¾èƒŒæ™¯ -->
    <div id="sparkle-container" class="fixed inset-0 pointer-events-none overflow-hidden z-0"></div>

    <!-- é ‚éƒ¨è£é£¾ï¼šç‡ˆç±  -->
    <div class="fixed top-0 left-0 right-0 flex justify-between px-6 z-20">
        <div class="lantern text-2xl mt-[-2px]">ğŸ®</div>
        <div class="lantern text-2xl mt-[-2px]" style="animation-delay: 0.5s">ğŸ®</div>
    </div>

    <!-- ä¸»å…§å®¹å€ -->
    <main class="w-full max-w-md mx-auto text-center z-10 pt-10">
        <header class="mb-6">
            <h2 class="text-base opacity-80 tracking-widest mb-1">å¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨</h2>
            <h1 class="serif text-4xl font-black gold-text drop-shadow-lg mb-2">æ­è³€æ–°å–œ</h1>
            <p class="text-amber-200 text-sm opacity-90">èˆ‡å¤©ä½¿ç¬‘é•·ä¸€èµ·ï¼Œç”¨æ„›è¿æ–°å¹´</p>
        </header>

        <!-- äº’å‹•å€ï¼šé»æ“Šç¦è¢‹ -->
        <div id="main-action" class="relative py-4">
            <div id="luck-envelope" class="red-packet bg-gradient-to-br from-red-600 to-red-800 w-40 h-56 mx-auto rounded-xl shadow-2xl flex flex-col items-center justify-center border-4 border-amber-400 relative overflow-hidden">
                <div class="absolute top-0 w-full h-1/2 bg-red-700 border-b-2 border-amber-500 rounded-b-[50%]"></div>
                <div class="z-10 text-4xl mb-3">ğŸ§§</div>
                <div class="z-10 bg-amber-400 text-red-800 font-bold px-3 py-1 rounded-full text-sm shadow-inner">
                    é»æ“Šé–‹é‹
                </div>
                <div class="absolute bottom-3 text-amber-300 text-[9px] opacity-50">å¹¸ç¦æ™ºå¤šæ˜Ÿ</div>
            </div>
        </div>

        <!-- å¿«é€ŸåŠŸèƒ½éµ -->
        <div class="grid grid-cols-2 gap-3 mt-6">
            <button onclick="generateGreeting()" class="bg-red-900/40 border border-amber-500/20 backdrop-blur-sm p-3 rounded-2xl flex flex-col items-center">
                <span class="text-lg mb-1">âœï¸</span>
                <span class="text-[11px] opacity-90">å‰ç¥¥è©±</span>
            </button>
            <button onclick="showInstallationInfo()" class="bg-red-900/40 border border-amber-500/20 backdrop-blur-sm p-3 rounded-2xl flex flex-col items-center">
                <span class="text-lg mb-1">ğŸ“±</span>
                <span class="text-[11px] opacity-90">å®‰è£ App</span>
            </button>
        </div>
    </main>

    <!-- åº•éƒ¨è³‡è¨Š -->
    <footer class="text-center z-10 mt-6 opacity-50 text-[9px]">
        <p>Â© 2026 å¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨ | å¤©ä½¿ç¬‘é•·</p>
    </footer>

    <!-- å½ˆçª—å…§å®¹ (Modal) -->
    <div id="modal" class="fixed inset-0 z-50 flex items-center justify-center p-6 hidden">
        <div class="absolute inset-0 bg-black/85 backdrop-blur-md" onclick="closeModal()"></div>
        <div class="bg-white text-gray-800 w-full max-w-sm rounded-3xl p-6 shadow-2xl relative modal-enter">
            <button onclick="closeModal()" class="absolute top-3 right-4 text-gray-400 text-xl">&times;</button>
            <div id="modal-content" class="text-center">
                <!-- å‹•æ…‹æ³¨å…¥å…§å®¹ -->
            </div>
            <button onclick="closeModal()" class="w-full mt-6 bg-red-600 text-white py-2 rounded-xl font-bold text-xs hover:bg-red-700 transition-colors">
                æ”¶ä¸‹ç¥ç¦
            </button>
        </div>
    </div>

    <script>
        // 1. åˆå§‹åŒ– PWA Manifest
        const manifest = {
            "name": "æ­è³€æ–°å–œ - å¤©ä½¿ç¬‘é•·",
            "short_name": "å¹¸ç¦æ–°å¹´",
            "start_url": ".",
            "display": "standalone",
            "background_color": "#b91c1c",
            "theme_color": "#b91c1c",
            "icons": [{
                "src": "https://api.dicebear.com/7.x/noto-emoji/svg?seed=Lucky",
                "sizes": "512x512",
                "type": "image/svg+xml"
            }]
        };
        const manifestStr = JSON.stringify(manifest);
        const blob = new Blob([manifestStr], {type: 'application/json'});
        document.getElementById('manifest-placeholder').setAttribute('href', URL.createObjectURL(blob));

        // 2. ç¥ç¦èªåº«
        const blessings = [
            { title: "å¿ƒéˆæˆé•·", content: "æ–°çš„ä¸€å¹´ï¼Œé¡˜æˆ‘å€‘éƒ½èƒ½æˆç‚ºé‚£é¡†ã€é£›å¾—æ…¢çš„è¡›æ˜Ÿã€ï¼Œåœ¨è‡ªå·±çš„ç¯€å¥ä¸­ç™¼å…‰ç™¼äº®ã€‚", author: "å¤©ä½¿ç¬‘é•·" },
            { title: "æƒ…ç·’æ™ºæ…§", content: "ç•¶ä½ æƒ³å¼å‡ºä¾†çš„æ™‚å€™ï¼Œè¨˜å¾—å…ˆçµ¦å¿ƒéˆä¸€å€‹æ“æŠ±ã€‚æ–°å¹´ï¼Œå¾æº«æŸ”å°å¾…è‡ªå·±é–‹å§‹ã€‚", author: "å¤©ä½¿ç¬‘é•·" },
            { title: "å¹¸ç¦ç§˜è¨£", content: "ä¸–ç•Œå› æˆ‘è€Œç”œç¾ï¼Œå› ç‚ºæ„›æ˜¯æ•™é¤Šä¸­æœ€å¼·å¤§çš„åŠ›é‡ã€‚æ–°å¹´å¿«æ¨‚ï¼", author: "å¤©ä½¿ç¬‘é•·" },
            { title: "æ­£èƒ½é‡", content: "ç¬‘å£å¸¸é–‹ï¼Œå¥½äº‹è‡ªç„¶ä¾†ã€‚è®“æˆ‘å€‘ä¸€èµ·åœ¨æ–°å¹´è£¡ç·´ç¿’å¹¸ç¦ã€å¯¦è¸æ„›ã€‚", author: "å¤©ä½¿ç¬‘é•·" },
            { title: "è¦ªå­é€£çµ", content: "ä¸æ‰“ä¸ç½µä¸æ˜¯æ”¾ä»»ï¼Œè€Œæ˜¯ç”¨è…¦ç§‘å­¸ç†è§£å­©å­ã€‚æ–°çš„ä¸€å¹´ï¼Œèˆ‡å­©å­é‡æ–°å»ºç«‹æ„›çš„é€£çµã€‚", author: "å¤©ä½¿ç¬‘é•·" }
        ];

        const luckyPhrases = [
            "é¾é¨°è™èº å¹¸ç¦ç›¸éš¨", "å¤§å‰å¤§åˆ© æ„›åœ¨ç•¶ä¸‹", "å¹³å®‰å–œæ¨‚ æ™ºæ…§å¢é•·", 
            "äº”ç¦è‡¨é–€ æ•™é¤Šé †é‚", "è¬äº‹å¦‚æ„ å¿ƒéˆè‡ªç”±", "å¯Œè²´å¹³å®‰ å¹¸ç¦æ»¿æ»¿"
        ];

        // 3. åŠŸèƒ½ï¼šé ˜å–ç¦è¢‹
        document.getElementById('luck-envelope').addEventListener('click', () => {
            const b = blessings[Math.floor(Math.random() * blessings.length)];
            const content = `
                <div class="text-red-600 text-[10px] font-bold mb-1 tracking-widest">â”€â”€ ${b.title} â”€â”€</div>
                <div class="text-base serif font-bold text-gray-800 leading-relaxed mb-4 px-2">
                    ã€Œ${b.content}ã€
                </div>
                <div class="text-gray-400 text-[10px] italic">â€” ${b.author}</div>
            `;
            showModal(content);
        });

        // 4. åŠŸèƒ½ï¼šå‰ç¥¥è©±ç”¢ç”Ÿå™¨
        function generateGreeting() {
            const phrase = luckyPhrases[Math.floor(Math.random() * luckyPhrases.length)];
            const content = `
                <div class="text-3xl mb-2">âœ¨</div>
                <h3 class="text-base font-black text-red-700 mb-3">éš¨æ©Ÿé–‹é‹å‰è¨€</h3>
                <div class="text-xl serif font-bold bg-amber-50 p-3 rounded-lg border border-amber-200">
                    ${phrase}
                </div>
            `;
            showModal(content);
        }

        // 5. åŠŸèƒ½ï¼šå®‰è£èªªæ˜
        function showInstallationInfo() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            let steps = "";
            if (isIOS) {
                steps = "é»æ“Šç€è¦½å™¨åº•éƒ¨çš„ã€Œåˆ†äº«ã€æŒ‰éˆ•ï¼Œç„¶å¾Œé¸æ“‡ã€ŒåŠ å…¥ä¸»ç•«é¢ã€ã€‚";
            } else {
                steps = "é»æ“Šç€è¦½å™¨å³ä¸Šè§’çš„ã€Œä¸‰å€‹é»ã€åœ–ç¤ºï¼Œç„¶å¾Œé¸æ“‡ã€Œå®‰è£æ‡‰ç”¨ç¨‹å¼ã€ã€‚";
            }
            const content = `
                <div class="text-3xl mb-2">ğŸ“±</div>
                <h3 class="text-base font-bold mb-2">å°‡å¹¸ç¦å¸¶åœ¨èº«ä¸Š</h3>
                <p class="text-gray-500 text-xs mb-4">æ‚¨å¯ä»¥å°‡æ­¤ App åŠ å…¥ä¸»ç•«é¢ï¼Œéš¨æ™‚ç²å–å¤©ä½¿ç¬‘é•·çš„ç¥ç¦ã€‚</p>
                <div class="bg-gray-50 p-3 rounded-xl text-[11px] text-left border-l-4 border-red-500 text-gray-600">
                    ${steps}
                </div>
            `;
            showModal(content);
        }

        function showModal(content) {
            document.getElementById('modal-content').innerHTML = content;
            document.getElementById('modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal').classList.add('hidden');
        }

        function createSparkles() {
            const container = document.getElementById('sparkle-container');
            const colors = ['#fde68a', '#f59e0b', '#ffffff'];
            for (let i = 0; i < 20; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                const size = Math.random() * 2 + 1.5 + 'px';
                sparkle.style.width = size;
                sparkle.style.height = size;
                sparkle.style.left = Math.random() * 100 + 'vw';
                sparkle.style.top = '-10px';
                sparkle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                sparkle.style.opacity = Math.random() * 0.6;
                sparkle.style.animationDuration = Math.random() * 3 + 5 + 's';
                sparkle.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(sparkle);
            }
        }

        window.onload = () => {
            createSparkles();
            if ('serviceWorker' in navigator) {
                const swCode = `
                    self.addEventListener('install', (e) => {
                        e.waitUntil(caches.open('pwa-v3').then(c => c.addAll(['/'])));
                    });
                    self.addEventListener('fetch', (e) => {
                        e.respondWith(caches.match(e.request).then(r => r || fetch(e.request)));
                    });
                `;
                const swBlob = new Blob([swCode], {type: 'application/javascript'});
                const swUrl = URL.createObjectURL(swBlob);
                navigator.serviceWorker.register(swUrl).catch(() => {});
            }
        };
    </script>
</body>
</html>

